<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1340px" preserveAspectRatio="none" style="width:1419px;height:1340px;" version="1.1" viewBox="0 0 1419 1340" width="1419px" zoomAndPan="magnify"><defs><filter height="300%" id="f18b6lpdlpbcg4" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="149" x="638.5" y="18.6855">Repository Pattern</text><!--cluster App--><polygon fill="#FFA500" filter="url(#f18b6lpdlpbcg4)" points="546,212.1406,556,202.1406,1122,202.1406,1122,618.6406,1112,628.6406,546,628.6406,546,212.1406" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1112" x2="1121" y1="212.1406" y2="203.1406"/><line style="stroke: #000000; stroke-width: 1.5;" x1="546" x2="1112" y1="212.1406" y2="212.1406"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1112" x2="1112" y1="212.1406" y2="628.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="84" x="788" y="229.6738">Custom App</text><!--cluster Domain--><polygon fill="#FFFFFF" filter="url(#f18b6lpdlpbcg4)" points="926,251.1406,984,251.1406,991,274.75,1098,274.75,1098,604.6406,926,604.6406,926,251.1406" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="926" x2="991" y1="274.75" y2="274.75"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="52" x="930" y="267.6738">Domain</text><!--cluster DomainServices--><polygon fill="#FFFFFF" filter="url(#f18b6lpdlpbcg4)" points="570,285.6406,690,285.6406,697,309.25,902,309.25,902,604.6406,570,604.6406,570,285.6406" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="570" x2="697" y1="309.25" y2="309.25"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="114" x="574" y="302.1738">DomainServices</text><!--cluster SqlServer--><polygon fill="#90EE90" filter="url(#f18b6lpdlpbcg4)" points="238,283.6406,248,273.6406,522,273.6406,522,382.6406,512,392.6406,238,392.6406,238,283.6406" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="512" x2="521" y1="283.6406" y2="274.6406"/><line style="stroke: #000000; stroke-width: 1.5;" x1="238" x2="512" y1="283.6406" y2="283.6406"/><line style="stroke: #000000; stroke-width: 1.5;" x1="512" x2="512" y1="283.6406" y2="392.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="208" x="272" y="301.1738">OnionSeed.Data.SqlServer.dll</text><!--cluster OnionSeed--><polygon fill="#ADD8E6" filter="url(#f18b6lpdlpbcg4)" points="338,704.6406,348,694.6406,1099,694.6406,1099,1163.6406,1089,1173.6406,338,1173.6406,338,704.6406" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1089" x2="1098" y1="704.6406" y2="695.6406"/><line style="stroke: #000000; stroke-width: 1.5;" x1="338" x2="1089" y1="704.6406" y2="704.6406"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1089" x2="1089" y1="704.6406" y2="1173.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="134" x="647.5" y="722.1738">OnionSeed.Data.dll</text><!--cluster DataAccess--><rect fill="#FFFFFF" filter="url(#f18b6lpdlpbcg4)" height="406" style="stroke: #000000; stroke-width: 1.5;" width="534" x="362" y="743.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="158" x="550" y="760.1738">(choose your strategy)</text><!--class Domain.Car--><rect fill="#FEFECE" filter="url(#f18b6lpdlpbcg4)" height="117.1797" id="Domain.Car" style="stroke: #A80036; stroke-width: 1.5;" width="140" x="942" y="287.1406"/><ellipse cx="997.75" cy="303.1406" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1000.5156,299.0156 Q1000.6719,298.7969 1000.8594,298.6875 Q1001.0469,298.5781 1001.2656,298.5781 Q1001.6406,298.5781 1001.875,298.8438 Q1002.1094,299.0938 1002.1094,299.7031 L1002.1094,301.1563 Q1002.1094,301.7656 1001.875,302.0313 Q1001.6406,302.2969 1001.2656,302.2969 Q1000.9219,302.2969 1000.7188,302.0938 Q1000.5156,301.9063 1000.4063,301.3906 Q1000.3594,301.0313 1000.1719,300.8438 Q999.8438,300.4688 999.2344,300.25 Q998.625,300.0313 998,300.0313 Q997.2344,300.0313 996.5938,300.3594 Q995.9688,300.6875 995.4688,301.4375 Q994.9844,302.1875 994.9844,303.2188 L994.9844,304.3125 Q994.9844,305.5469 995.875,306.375 Q996.7656,307.1875 998.3594,307.1875 Q999.2969,307.1875 999.9531,306.9375 Q1000.3438,306.7813 1000.7656,306.3438 Q1001.0313,306.0781 1001.1719,306 Q1001.3281,305.9219 1001.5313,305.9219 Q1001.8594,305.9219 1002.1094,306.1875 Q1002.375,306.4375 1002.375,306.7813 Q1002.375,307.125 1002.0313,307.5313 Q1001.5313,308.1094 1000.7344,308.4375 Q999.6563,308.8906 998.3594,308.8906 Q996.8438,308.8906 995.6406,308.2656 Q994.6563,307.7656 993.9688,306.7031 Q993.2813,305.625 993.2813,304.3438 L993.2813,303.1875 Q993.2813,301.8594 993.8906,300.7188 Q994.5156,299.5625 995.6094,298.9531 Q996.7031,298.3281 997.9375,298.3281 Q998.6719,298.3281 999.3125,298.5 Q999.9688,298.6563 1000.5156,299.0156 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="20" x="1018.25" y="308.0508">Car</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="943" x2="1081" y1="319.1406" y2="319.1406"/><ellipse cx="953" cy="331.5586" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="89" x="962" y="334.5596">Id : Guid {get; set;}</text><ellipse cx="953" cy="345.3945" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="113" x="962" y="348.3955">Name : string {get; set;}</text><ellipse cx="953" cy="359.2305" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="114" x="962" y="362.2314">Model : string {get; set;}</text><ellipse cx="953" cy="373.0664" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="102" x="962" y="376.0674">Vin : string {get; set;}</text><ellipse cx="953" cy="386.9023" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="109" x="962" y="389.9033">Color : Color {get; set;}</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="943" x2="1081" y1="396.3203" y2="396.3203"/><!--class Domain.ICar--><rect fill="#FEFECE" filter="url(#f18b6lpdlpbcg4)" height="103.3438" id="Domain.ICar" style="stroke: #A80036; stroke-width: 1.5;" width="105" x="971.5" y="485.6406"/><ellipse cx="1008.55" cy="501.6406" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1009.5031,498.2813 L1009.5031,504.9375 L1011.2219,504.9375 Q1011.8313,504.9375 1012.0969,505.1719 Q1012.3625,505.4063 1012.3625,505.7969 Q1012.3625,506.1719 1012.0969,506.4063 Q1011.8313,506.6406 1011.2219,506.6406 L1006.0813,506.6406 Q1005.4719,506.6406 1005.2063,506.4063 Q1004.9406,506.1719 1004.9406,505.7813 Q1004.9406,505.4063 1005.2063,505.1719 Q1005.4719,504.9375 1006.0813,504.9375 L1007.8,504.9375 L1007.8,498.2813 L1006.0813,498.2813 Q1005.4719,498.2813 1005.2063,498.0469 Q1004.9406,497.8125 1004.9406,497.4219 Q1004.9406,497.0469 1005.2063,496.8125 Q1005.4719,496.5781 1006.0813,496.5781 L1011.2219,496.5781 Q1011.8313,496.5781 1012.0969,496.8125 Q1012.3625,497.0469 1012.3625,497.4219 Q1012.3625,497.8125 1012.0969,498.0469 Q1011.8313,498.2813 1011.2219,498.2813 L1009.5031,498.2813 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="24" x="1027.45" y="506.5508">ICar</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="972.5" x2="1075.5" y1="517.6406" y2="517.6406"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="92" x="977.5" y="533.0596">Name : string {get;}</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="93" x="977.5" y="546.8955">Model : string {get;}</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="81" x="977.5" y="560.7314">Vin : string {get;}</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="88" x="977.5" y="574.5674">Color : Color {get;}</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="972.5" x2="1075.5" y1="580.9844" y2="580.9844"/><!--class DomainServices.CarRepository--><rect fill="#FEFECE" filter="url(#f18b6lpdlpbcg4)" height="48" id="DomainServices.CarRepository" style="stroke: #A80036; stroke-width: 1.5;" width="111" x="680.5" y="321.6406"/><ellipse cx="695.5" cy="337.6406" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M698.2656,333.5156 Q698.4219,333.2969 698.6094,333.1875 Q698.7969,333.0781 699.0156,333.0781 Q699.3906,333.0781 699.625,333.3438 Q699.8594,333.5938 699.8594,334.2031 L699.8594,335.6563 Q699.8594,336.2656 699.625,336.5313 Q699.3906,336.7969 699.0156,336.7969 Q698.6719,336.7969 698.4688,336.5938 Q698.2656,336.4063 698.1563,335.8906 Q698.1094,335.5313 697.9219,335.3438 Q697.5938,334.9688 696.9844,334.75 Q696.375,334.5313 695.75,334.5313 Q694.9844,334.5313 694.3438,334.8594 Q693.7188,335.1875 693.2188,335.9375 Q692.7344,336.6875 692.7344,337.7188 L692.7344,338.8125 Q692.7344,340.0469 693.625,340.875 Q694.5156,341.6875 696.1094,341.6875 Q697.0469,341.6875 697.7031,341.4375 Q698.0938,341.2813 698.5156,340.8438 Q698.7813,340.5781 698.9219,340.5 Q699.0781,340.4219 699.2813,340.4219 Q699.6094,340.4219 699.8594,340.6875 Q700.125,340.9375 700.125,341.2813 Q700.125,341.625 699.7813,342.0313 Q699.2813,342.6094 698.4844,342.9375 Q697.4063,343.3906 696.1094,343.3906 Q694.5938,343.3906 693.3906,342.7656 Q692.4063,342.2656 691.7188,341.2031 Q691.0313,340.125 691.0313,338.8438 L691.0313,337.6875 Q691.0313,336.3594 691.6406,335.2188 Q692.2656,334.0625 693.3594,333.4531 Q694.4531,332.8281 695.6875,332.8281 Q696.4219,332.8281 697.0625,333 Q697.7188,333.1563 698.2656,333.5156 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="79" x="709.5" y="342.5508">CarRepository</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="681.5" x2="790.5" y1="353.6406" y2="353.6406"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="681.5" x2="790.5" y1="361.6406" y2="361.6406"/><!--class DomainServices.ICarRepository--><rect fill="#FEFECE" filter="url(#f18b6lpdlpbcg4)" height="103.3438" id="DomainServices.ICarRepository" style="stroke: #A80036; stroke-width: 1.5;" width="299" x="586.5" y="485.6406"/><ellipse cx="690.25" cy="501.6406" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M691.2031,498.2813 L691.2031,504.9375 L692.9219,504.9375 Q693.5313,504.9375 693.7969,505.1719 Q694.0625,505.4063 694.0625,505.7969 Q694.0625,506.1719 693.7969,506.4063 Q693.5313,506.6406 692.9219,506.6406 L687.7813,506.6406 Q687.1719,506.6406 686.9063,506.4063 Q686.6406,506.1719 686.6406,505.7813 Q686.6406,505.4063 686.9063,505.1719 Q687.1719,504.9375 687.7813,504.9375 L689.5,504.9375 L689.5,498.2813 L687.7813,498.2813 Q687.1719,498.2813 686.9063,498.0469 Q686.6406,497.8125 686.6406,497.4219 Q686.6406,497.0469 686.9063,496.8125 Q687.1719,496.5781 687.7813,496.5781 L692.9219,496.5781 Q693.5313,496.5781 693.7969,496.8125 Q694.0625,497.0469 694.0625,497.4219 Q694.0625,497.8125 693.7969,498.0469 Q693.5313,498.2813 692.9219,498.2813 L691.2031,498.2813 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="83" x="710.75" y="506.5508">ICarRepository</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="587.5" x2="884.5" y1="517.6406" y2="517.6406"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="587.5" x2="884.5" y1="525.6406" y2="525.6406"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="219" x="592.5" y="541.0596">GetByName(string value) : IEnumerable&lt;ICar&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="287" x="592.5" y="554.8955">GetByModelAsync(string value) : Task&lt;IEnumerable&lt;ICar&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="205" x="592.5" y="568.7314">GetByVinAsync(string value) : Task&lt;ICar&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="127" x="592.5" y="582.5674">Paint(ICar car, Color color)</text><!--class SqlRepository--><rect fill="#FEFECE" filter="url(#f18b6lpdlpbcg4)" height="61.8359" id="SqlRepository" style="stroke: #A80036; stroke-width: 1.5;" width="200" x="306" y="314.6406"/><ellipse cx="321" cy="330.6406" fill="#A9DCDF" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M323.1875,332.4063 L319.0469,332.4063 L318.625,333.4375 L319.0469,333.4375 Q319.6563,333.4375 319.9219,333.6719 Q320.1875,333.9063 320.1875,334.2969 Q320.1875,334.6719 319.9219,334.9063 Q319.6563,335.1406 319.0469,335.1406 L316.75,335.1406 Q316.1406,335.1406 315.8906,334.9063 Q315.625,334.6719 315.625,334.2813 Q315.625,333.9063 315.9063,333.6719 Q316.1719,333.4219 316.7969,333.4375 L319.4688,326.7813 L318.3594,326.7813 Q317.75,326.7813 317.4844,326.5469 Q317.2188,326.3125 317.2188,325.9219 Q317.2188,325.5469 317.4844,325.3125 Q317.75,325.0781 318.3594,325.0781 L322.0313,325.0781 L325.4219,333.4375 Q326.0156,333.4375 326.2031,333.5781 Q326.5938,333.8438 326.5938,334.2969 Q326.5938,334.6719 326.3281,334.9063 Q326.0781,335.1406 325.4688,335.1406 L323.1719,335.1406 Q322.5625,335.1406 322.2969,334.9063 Q322.0313,334.6719 322.0313,334.2813 Q322.0313,333.9063 322.2969,333.6719 Q322.5625,333.4375 323.1719,333.4375 L323.5938,333.4375 L323.1875,332.4063 Z M322.4688,330.7031 L321.1094,327.3281 L319.7344,330.7031 L322.4688,330.7031 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="77" x="335" y="335.5508">SqlRepository</text><rect fill="#FFFFFF" height="17.0938" style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" width="89" x="420" y="311.6406"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="87" x="421" y="325.0977">TEntity,TIdentity</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="307" x2="505" y1="346.6406" y2="346.6406"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="307" x2="505" y1="354.6406" y2="354.6406"/><ellipse cx="317" cy="367.0586" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="152" x="326" y="370.0596">ctor(SqlConnection connection)</text><!--class IEntity--><rect fill="#FEFECE" filter="url(#f18b6lpdlpbcg4)" height="61.8359" id="IEntity" style="stroke: #A80036; stroke-width: 1.5;" width="117" x="965.5" y="800.1406"/><ellipse cx="980.5" cy="816.1406" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M981.4531,812.7813 L981.4531,819.4375 L983.1719,819.4375 Q983.7813,819.4375 984.0469,819.6719 Q984.3125,819.9063 984.3125,820.2969 Q984.3125,820.6719 984.0469,820.9063 Q983.7813,821.1406 983.1719,821.1406 L978.0313,821.1406 Q977.4219,821.1406 977.1563,820.9063 Q976.8906,820.6719 976.8906,820.2813 Q976.8906,819.9063 977.1563,819.6719 Q977.4219,819.4375 978.0313,819.4375 L979.75,819.4375 L979.75,812.7813 L978.0313,812.7813 Q977.4219,812.7813 977.1563,812.5469 Q976.8906,812.3125 976.8906,811.9219 Q976.8906,811.5469 977.1563,811.3125 Q977.4219,811.0781 978.0313,811.0781 L983.1719,811.0781 Q983.7813,811.0781 984.0469,811.3125 Q984.3125,811.5469 984.3125,811.9219 Q984.3125,812.3125 984.0469,812.5469 Q983.7813,812.7813 983.1719,812.7813 L981.4531,812.7813 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="34" x="994.5" y="821.0508">IEntity</text><rect fill="#FFFFFF" height="17.0938" style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" width="49" x="1036.5" y="797.1406"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="47" x="1037.5" y="810.5977">TIdentity</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="966.5" x2="1081.5" y1="832.1406" y2="832.1406"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="86" x="971.5" y="847.5596">Id : TIdentity {get;}</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="966.5" x2="1081.5" y1="853.9766" y2="853.9766"/><!--class IRepository--><rect fill="#FEFECE" filter="url(#f18b6lpdlpbcg4)" height="48" id="IRepository" style="stroke: #A80036; stroke-width: 1.5;" width="186" x="378" y="807.1406"/><ellipse cx="393" cy="823.1406" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M393.9531,819.7813 L393.9531,826.4375 L395.6719,826.4375 Q396.2813,826.4375 396.5469,826.6719 Q396.8125,826.9063 396.8125,827.2969 Q396.8125,827.6719 396.5469,827.9063 Q396.2813,828.1406 395.6719,828.1406 L390.5313,828.1406 Q389.9219,828.1406 389.6563,827.9063 Q389.3906,827.6719 389.3906,827.2813 Q389.3906,826.9063 389.6563,826.6719 Q389.9219,826.4375 390.5313,826.4375 L392.25,826.4375 L392.25,819.7813 L390.5313,819.7813 Q389.9219,819.7813 389.6563,819.5469 Q389.3906,819.3125 389.3906,818.9219 Q389.3906,818.5469 389.6563,818.3125 Q389.9219,818.0781 390.5313,818.0781 L395.6719,818.0781 Q396.2813,818.0781 396.5469,818.3125 Q396.8125,818.5469 396.8125,818.9219 Q396.8125,819.3125 396.5469,819.5469 Q396.2813,819.7813 395.6719,819.7813 L393.9531,819.7813 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="63" x="407" y="828.0508">IRepository</text><rect fill="#FFFFFF" height="17.0938" style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" width="89" x="478" y="804.1406"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="87" x="479" y="817.5977">TEntity,TIdentity</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="379" x2="563" y1="839.1406" y2="839.1406"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="379" x2="563" y1="847.1406" y2="847.1406"/><!--class IQueryService--><rect fill="#FEFECE" filter="url(#f18b6lpdlpbcg4)" height="103.3438" id="IQueryService" style="stroke: #A80036; stroke-width: 1.5;" width="233" x="646.5" y="779.6406"/><ellipse cx="675.9" cy="795.6406" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M676.8531,792.2813 L676.8531,798.9375 L678.5719,798.9375 Q679.1813,798.9375 679.4469,799.1719 Q679.7125,799.4063 679.7125,799.7969 Q679.7125,800.1719 679.4469,800.4063 Q679.1813,800.6406 678.5719,800.6406 L673.4313,800.6406 Q672.8219,800.6406 672.5563,800.4063 Q672.2906,800.1719 672.2906,799.7813 Q672.2906,799.4063 672.5563,799.1719 Q672.8219,798.9375 673.4313,798.9375 L675.15,798.9375 L675.15,792.2813 L673.4313,792.2813 Q672.8219,792.2813 672.5563,792.0469 Q672.2906,791.8125 672.2906,791.4219 Q672.2906,791.0469 672.5563,790.8125 Q672.8219,790.5781 673.4313,790.5781 L678.5719,790.5781 Q679.1813,790.5781 679.4469,790.8125 Q679.7125,791.0469 679.7125,791.4219 Q679.7125,791.8125 679.4469,792.0469 Q679.1813,792.2813 678.5719,792.2813 L676.8531,792.2813 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="78" x="693.1" y="800.5508">IQueryService</text><rect fill="#FFFFFF" height="17.0938" style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" width="89" x="793.5" y="776.6406"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="87" x="794.5" y="790.0977">TEntity,TIdentity</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="647.5" x2="878.5" y1="811.6406" y2="811.6406"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="647.5" x2="878.5" y1="819.6406" y2="819.6406"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="149" x="652.5" y="835.0596">GetCountAsync() : Task&lt;long&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="215" x="652.5" y="848.8955">GetAllAsync() : Task&lt;IEnumerable&lt;TEntity&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="205" x="652.5" y="862.7314">GetByIdAsync(TIdentity id) : Task&lt;TEntity&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="221" x="652.5" y="876.5674">TryGetByIdAsync(TIdentity id) : Task&lt;TEntity&gt;</text><!--class ICommandService--><rect fill="#FEFECE" filter="url(#f18b6lpdlpbcg4)" height="172.5234" id="ICommandService" style="stroke: #A80036; stroke-width: 1.5;" width="227" x="651.5" y="960.6406"/><ellipse cx="666.5" cy="976.6406" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M667.4531,973.2813 L667.4531,979.9375 L669.1719,979.9375 Q669.7813,979.9375 670.0469,980.1719 Q670.3125,980.4063 670.3125,980.7969 Q670.3125,981.1719 670.0469,981.4063 Q669.7813,981.6406 669.1719,981.6406 L664.0313,981.6406 Q663.4219,981.6406 663.1563,981.4063 Q662.8906,981.1719 662.8906,980.7813 Q662.8906,980.4063 663.1563,980.1719 Q663.4219,979.9375 664.0313,979.9375 L665.75,979.9375 L665.75,973.2813 L664.0313,973.2813 Q663.4219,973.2813 663.1563,973.0469 Q662.8906,972.8125 662.8906,972.4219 Q662.8906,972.0469 663.1563,971.8125 Q663.4219,971.5781 664.0313,971.5781 L669.1719,971.5781 Q669.7813,971.5781 670.0469,971.8125 Q670.3125,972.0469 670.3125,972.4219 Q670.3125,972.8125 670.0469,973.0469 Q669.7813,973.2813 669.1719,973.2813 L667.4531,973.2813 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="104" x="680.5" y="981.5508">ICommandService</text><rect fill="#FFFFFF" height="17.0938" style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" width="89" x="792.5" y="957.6406"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="87" x="793.5" y="971.0977">TEntity,TIdentity</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="652.5" x2="877.5" y1="992.6406" y2="992.6406"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="652.5" x2="877.5" y1="1000.6406" y2="1000.6406"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="146" x="657.5" y="1016.0596">AddAsync(TEntity item) : Task</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="192" x="657.5" y="1029.8955">AddOrUpdateAsync(TEntity item) : Task</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="160" x="657.5" y="1043.7314">UpdateAsync(TEntity item) : Task</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="165" x="657.5" y="1057.5674">RemoveAsync(TEntity item) : Task</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="162" x="657.5" y="1071.4033">RemoveAsync(TIdentity id) : Task</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="194" x="657.5" y="1085.2393">TryAddAsync(TEntity item) : Task&lt;bool&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="208" x="657.5" y="1099.0752">TryUpdateAsync(TEntity item) : Task&lt;bool&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="213" x="657.5" y="1112.9111">TryRemoveAsync(TEntity item) : Task&lt;bool&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="210" x="657.5" y="1126.7471">TryRemoveAsync(TIdentity id) : Task&lt;bool&gt;</text><path d="M6,283.6406 L6,408.1016 A0,0 0 0 0 6,408.1016 L222,408.1016 A0,0 0 0 0 222,408.1016 L222,349.6406 L305.775,345.6406 L222,341.6406 L222,293.6406 L212,283.6406 L6,283.6406 A0,0 0 0 0 6,283.6406 " fill="#FBFB77" filter="url(#f18b6lpdlpbcg4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M212,283.6406 L212,293.6406 L222,293.6406 L212,283.6406 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="12" y="302.1357">Provides base implementations</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="12" y="318.4873">of the</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="65" x="48" y="318.4873">IRepository</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="113" y="318.4873">,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="81" x="121" y="318.4873">IQueryService</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="202" y="318.4873">,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="12" y="334.8389">and</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="106" x="37" y="334.8389">ICommandService</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="147" y="334.8389">interfaces,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="12" y="351.1904">specifically targeting SQL Server.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="16" y="367.542"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="12" y="383.8936">Base classes like this are meant</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="12" y="400.2451">to be extended by applications.</text><path d="M545,31.1406 L545,155.6016 A0,0 0 0 0 545,155.6016 L732,155.6016 L736,321.4206 L740,155.6016 L927,155.6016 A0,0 0 0 0 927,155.6016 L927,41.1406 L917,31.1406 L545,31.1406 A0,0 0 0 0 545,31.1406 " fill="#FBFB77" filter="url(#f18b6lpdlpbcg4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M917,31.1406 L917,41.1406 L927,41.1406 L917,31.1406 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="85" x="551" y="49.6357">ICarRepository</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="640" y="49.6357">can extend</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="65" x="708" y="49.6357">IRepository</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="773" y="49.6357">,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="81" x="781" y="49.6357">IQueryService</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="11" x="866" y="49.6357">or</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="106" x="551" y="65.9873">ICommandService</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="661" y="65.9873">as needed, and the</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="80" x="776" y="65.9873">SqlRepository</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="860" y="65.9873">base</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="361" x="551" y="82.3389">class provides default implementations for all that functionality.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="555" y="98.6904"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="551" y="115.042">Because of this,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="85" x="649" y="115.042">ICarRepository</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="738" y="115.042">and</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="81" x="763" y="115.042">CarRepository</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="848" y="115.042">only</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="356" x="551" y="131.3936">need to define and implement custom queries and operations,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="268" x="551" y="147.7451">as the default operations are handled for them.</text><path d="M1138.5,316.1406 L1138.5,341.6406 L1082.18,345.6406 L1138.5,349.6406 L1138.5,375.1953 A0,0 0 0 0 1138.5,375.1953 L1337.5,375.1953 A0,0 0 0 0 1337.5,375.1953 L1337.5,326.1406 L1327.5,316.1406 L1138.5,316.1406 A0,0 0 0 0 1138.5,316.1406 " fill="#FBFB77" filter="url(#f18b6lpdlpbcg4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1327.5,316.1406 L1327.5,326.1406 L1337.5,326.1406 L1327.5,316.1406 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="20" x="1144.5" y="334.6357">Car</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="1168.5" y="334.6357">is built to address specific</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="1144.5" y="350.9873">implementation requiremets for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="1144.5" y="367.3389">things like DB persistance.</text><path d="M1138.5,499.6406 L1138.5,533.1406 L1076.52,537.1406 L1138.5,541.1406 L1138.5,575.0469 A0,0 0 0 0 1138.5,575.0469 L1407.5,575.0469 A0,0 0 0 0 1407.5,575.0469 L1407.5,509.6406 L1397.5,499.6406 L1138.5,499.6406 A0,0 0 0 0 1138.5,499.6406 " fill="#FBFB77" filter="url(#f18b6lpdlpbcg4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1397.5,499.6406 L1397.5,509.6406 L1407.5,509.6406 L1397.5,499.6406 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="24" x="1144.5" y="518.1357">ICar</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="1172.5" y="518.1357">is what should largely be used</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="1144.5" y="534.4873">in business logic, because it can</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="226" x="1144.5" y="550.8389">enforce constraints better than a class.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="1144.5" y="567.1904">(Read-only properties, no constructor, etc.)</text><path d="M576,1220.6406 L576,1328.75 A0,0 0 0 0 576,1328.75 L954,1328.75 A0,0 0 0 0 954,1328.75 L954,1230.6406 L944,1220.6406 L769,1220.6406 L765,1133.7136 L761,1220.6406 L576,1220.6406 A0,0 0 0 0 576,1220.6406 " fill="#FBFB77" filter="url(#f18b6lpdlpbcg4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M944,1220.6406 L944,1230.6406 L954,1230.6406 L944,1220.6406 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="9" x="582" y="1239.1357">A</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="61" x="595" y="1239.1357">Repository</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="254" x="660" y="1239.1357">is an unordered collection of unique entities.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="9" x="582" y="1255.4873">A</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="77" x="595" y="1255.4873">QueryService</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="676" y="1255.4873">is the "read-only" portion of a</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="61" x="847" y="1255.4873">Repository</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="908" y="1255.4873">.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="9" x="582" y="1271.8389">A</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="102" x="595" y="1271.8389">CommandService</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="701" y="1271.8389">is the "write-only" portion of a</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="61" x="874" y="1271.8389">Repository</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="935" y="1271.8389">.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="586" y="1288.1904"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="342" x="582" y="1304.542">This separation helps when implementing CQ(R)S patterns.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="352" x="582" y="1320.8936">There are both sync- and async- versions of these interfaces.</text><path d="M1117.5,801.6406 L1117.5,827.1406 L1082.63,831.1406 L1117.5,835.1406 L1117.5,860.6953 A0,0 0 0 0 1117.5,860.6953 L1310.5,860.6953 A0,0 0 0 0 1310.5,860.6953 L1310.5,811.6406 L1300.5,801.6406 L1117.5,801.6406 A0,0 0 0 0 1117.5,801.6406 " fill="#FBFB77" filter="url(#f18b6lpdlpbcg4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1300.5,801.6406 L1300.5,811.6406 L1310.5,811.6406 L1300.5,801.6406 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="50" x="1123.5" y="820.1357">TIdentity</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="14" x="1177.5" y="820.1357">is:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="129" x="1155.5" y="836.4873">IEquatable&lt;TIdentity&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="140" x="1155.5" y="852.8389">IComparable&lt;TIdentity&gt;</text><path d="M1115,1025.6406 L1115,1043.1406 L878.688,1047.1406 L1115,1051.1406 L1115,1068.3438 A0,0 0 0 0 1115,1068.3438 L1271,1068.3438 A0,0 0 0 0 1271,1068.3438 L1271,1035.6406 L1261,1025.6406 L1115,1025.6406 A0,0 0 0 0 1115,1025.6406 " fill="#FBFB77" filter="url(#f18b6lpdlpbcg4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1261,1025.6406 L1261,1035.6406 L1271,1035.6406 L1261,1025.6406 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="41" x="1121" y="1044.1357">TEntity</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="14" x="1166" y="1044.1357">is:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="103" x="1153" y="1060.4873">IEntity&lt;TIdentity&gt;</text><!--link SqlRepository to DomainServices.CarRepository--><path d="M526.523,345.6406 C579.121,345.6406 638.236,345.6406 680.222,345.6406 " fill="none" id="SqlRepository-DomainServices.CarRepository" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="526.355,352.6406,506.355,345.6406,526.355,338.6406,526.355,352.6406" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="570.25" y="323.1357">extends</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="71" x="557.75" y="339.4873">&lt;Car, Guid&gt;</text><!--link SqlRepository to IRepository--><path d="M410.066,376.8856 C421.205,459.7426 452.242,690.6096 465.2,786.9996 " fill="none" id="SqlRepository-IRepository" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="472.154,786.1886,467.881,806.9426,458.279,788.0536,472.154,786.1886" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="446" y="542.6357">implements</text><!--link DomainServices.CarRepository to Domain.Car--><path d="M804.664,345.6406 C846.474,345.6406 899.756,345.6406 941.837,345.6406 " fill="none" id="DomainServices.CarRepository-Domain.Car" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#FFFFFF" points="791.521,345.6406,797.521,349.6406,803.521,345.6406,797.521,341.6406,791.521,345.6406" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="817.75" y="339.1357">actually contains</text><!--link DomainServices.CarRepository to DomainServices.ICarRepository--><path d="M736,369.8766 C736,393.6126 736,431.6616 736,465.3746 " fill="none" id="DomainServices.CarRepository-DomainServices.ICarRepository" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="743,465.6386,736,485.6386,729,465.6376,743,465.6386" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="737" y="452.1357">implements</text><!--link Domain.Car to Domain.ICar--><path d="M1015.65,404.2686 C1016.87,423.5036 1018.24,445.1616 1019.51,465.2826 " fill="none" id="Domain.Car-Domain.ICar" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="1026.52,465.1256,1020.79,485.5286,1012.54,466.0106,1026.52,465.1256" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="1019" y="452.1357">implements</text><!--link DomainServices.ICarRepository to Domain.ICar--><path d="M899.199,537.1406 C925.318,537.1406 950.578,537.1406 971.46,537.1406 " fill="none" id="DomainServices.ICarRepository-Domain.ICar" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="885.905,537.1406,891.905,541.1406,897.905,537.1406,891.905,533.1406,885.905,537.1406" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="904" y="530.6357">contains</text><!--link DomainServices.ICarRepository to IRepository--><path d="M690.143,588.6696 C637.631,646.5326 552.786,740.0216 505.551,792.0686 " fill="none" id="DomainServices.ICarRepository-IRepository" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="510.526,797.0036,491.901,807.1096,500.159,787.5956,510.526,797.0036" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="651.5" y="659.1357">extends</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="75" x="637" y="675.4873">&lt;ICar, Guid&gt;</text><!--link Domain.ICar to IEntity--><path d="M1024,588.6696 C1024,642.1816 1024,726.1646 1024,779.6596 " fill="none" id="Domain.ICar-IEntity" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1031,779.8746,1024,799.8746,1017,779.8746,1031,779.8746" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="1025" y="659.1357">extends</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="43" x="1026.5" y="675.4873">&lt;Guid&gt;</text><!--link IRepository to IQueryService--><path d="M564.193,831.1406 C583.988,831.1406 605.279,831.1406 626.312,831.1406 " fill="none" id="IRepository-IQueryService" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="626.341,824.1406,646.341,831.1406,626.341,838.1406,626.341,824.1406" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="582.25" y="824.6357">extends</text><!--link IRepository to ICommandService--><path d="M502.742,855.2456 C534.692,878.5016 586.107,915.9266 634.984,951.5036 " fill="none" id="IRepository-ICommandService" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="639.38,946.0456,651.431,963.4746,631.141,957.3646,639.38,946.0456" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="602" y="927.1357">extends</text><!--link IQueryService to ICommandService--><!--link IQueryService to IEntity--><path d="M892.978,831.1406 C918.3,831.1406 943.647,831.1406 965.208,831.1406 " fill="none" id="IQueryService-IEntity" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="879.759,831.1406,885.759,835.1406,891.759,831.1406,885.759,827.1406,879.759,831.1406" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="898" y="824.6357">contains</text><!--link IEntity to ICommandService--><path d="M987.441,862.3476 C959.089,885.7736 918.174,919.5796 879.146,951.8266 " fill="none" id="IEntity-ICommandService" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="868.739,960.4256,875.9123,959.6881,877.9904,952.7829,870.8171,953.5205,868.739,960.4256" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="927" y="927.1357">contains</text><!--
@startuml Repository


title Repository Pattern

node "Custom App" as App #Orange {
	namespace Domain #White {
		class Car {
			+ Id : Guid {get; set;}
			+ Name : string {get; set;}
			+ Model : string {get; set;}
			+ Vin : string {get; set;}
			+ Color : Color {get; set;}
		}

		interface ICar {
			Name : string {get;}
			Model : string {get;}
			Vin : string {get;}
			Color : Color {get;}
		}
	}

	namespace DomainServices #White {
		class CarRepository

		interface ICarRepository {
			GetByName(string value) : IEnumerable<ICar>
			GetByModelAsync(string value) : Task<IEnumerable<ICar>>
			GetByVinAsync(string value) : Task<ICar>
			Paint(ICar car, Color color)
		}
	}
}

node "OnionSeed.Data.SqlServer.dll" as SqlServer #LightGreen {
	abstract class SqlRepository<TEntity,TIdentity> {
		+ ctor(SqlConnection connection)
	}
}

node "OnionSeed.Data.dll" as OnionSeed #LightBlue {
	rectangle "(choose your strategy)" as DataAccess #White {
		interface IRepository<TEntity,TIdentity>

		interface IQueryService<TEntity,TIdentity> {
			GetCountAsync() : Task<long>
			GetAllAsync() : Task<IEnumerable<TEntity>>
			GetByIdAsync(TIdentity id) : Task<TEntity>
			TryGetByIdAsync(TIdentity id) : Task<TEntity>
		}

		interface ICommandService<TEntity,TIdentity> {
			AddAsync(TEntity item) : Task
			AddOrUpdateAsync(TEntity item) : Task
			UpdateAsync(TEntity item) : Task
			RemoveAsync(TEntity item) : Task
			RemoveAsync(TIdentity id) : Task
			TryAddAsync(TEntity item) : Task<bool>
			TryUpdateAsync(TEntity item) : Task<bool>
			TryRemoveAsync(TEntity item) : Task<bool>
			TryRemoveAsync(TIdentity id) : Task<bool>
		}
	}

	interface IEntity<TIdentity> {
		Id : TIdentity {get;}
	}
}

note left of SqlRepository
	Provides base implementations
	of the <i>IRepository</i>, <i>IQueryService</i>,
	and <i>ICommandService</i> interfaces,
	specifically targeting SQL Server.

	Base classes like this are meant
	to be extended by applications.
end note

SqlRepository <|- DomainServices.CarRepository : extends\n<i><Car, Guid></i>
SqlRepository ...|> IRepository : implements

DomainServices.CarRepository o. Domain.Car : actually contains
DomainServices.CarRepository ..|> DomainServices.ICarRepository : implements

Domain.Car ..|> Domain.ICar : implements

DomainServices.ICarRepository o- Domain.ICar : contains
DomainServices.ICarRepository - -|> IRepository : extends\n<i><ICar, Guid></i>

Domain.ICar - -|> IEntity : extends\n<i><Guid></i>

IRepository -|> IQueryService : extends
IRepository - -|> ICommandService : extends

IQueryService -[hidden]- ICommandService

IQueryService o- IEntity : contains
IEntity - -o ICommandService : contains

note top of DomainServices.CarRepository
	<i>ICarRepository</i> can extend <i>IRepository</i>, <i>IQueryService</i> or
	<i>ICommandService</i> as needed, and the <i>SqlRepository</i> base
	class provides default implementations for all that functionality.

	Because of this, <i>ICarRepository</i> and <i>CarRepository</i> only
	need to define and implement custom queries and operations,
	as the default operations are handled for them.
end note

note right of Domain.Car
	<i>Car</i> is built to address specific
	implementation requiremets for
	things like DB persistance.
end note

note right of Domain.ICar
	<i>ICar</i> is what should largely be used
	in business logic, because it can
	enforce constraints better than a class.
	(Read-only properties, no constructor, etc.)
end note

note bottom of ICommandService
	A <i>Repository</i> is an unordered collection of unique entities.
	A <i>QueryService</i> is the "read-only" portion of a <i>Repository</i>.
	A <i>CommandService</i> is the "write-only" portion of a <i>Repository</i>.

	This separation helps when implementing CQ(R)S patterns.
	There are both sync- and async- versions of these interfaces.
end note

note right of IEntity
	<i>TIdentity</i> is:
		<i>IEquatable<TIdentity></i>
		<i>IComparable<TIdentity></i>
end note

note right of ICommandService
	<i>TEntity</i> is:
		<i>IEntity<TIdentity></i>
end note

@enduml

PlantUML version 1.2019.03(Sun Mar 10 05:04:44 MDT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 11.0.1+13-LTS
Operating System: Windows 10
OS Version: 10.0
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>