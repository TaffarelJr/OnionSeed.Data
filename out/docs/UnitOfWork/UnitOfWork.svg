<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="480px" preserveAspectRatio="none" style="width:681px;height:480px;" version="1.1" viewBox="0 0 681 480" width="681px" zoomAndPan="magnify"><defs><filter height="300%" id="f1ovnh6b4qthuz" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="162" x="265.5" y="18.6855">Unit of Work Pattern</text><!--cluster SqlServer--><polygon fill="#90EE90" filter="url(#f1ovnh6b4qthuz)" points="375,96.1406,385,86.1406,659,86.1406,659,195.1406,649,205.1406,375,205.1406,375,96.1406" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="649" x2="658" y1="96.1406" y2="87.1406"/><line style="stroke: #000000; stroke-width: 1.5;" x1="375" x2="649" y1="96.1406" y2="96.1406"/><line style="stroke: #000000; stroke-width: 1.5;" x1="649" x2="649" y1="96.1406" y2="205.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="208" x="409" y="113.6738">OnionSeed.Data.SqlServer.dll</text><!--cluster OnionSeed--><polygon fill="#ADD8E6" filter="url(#f1ovnh6b4qthuz)" points="354,359.6406,364,349.6406,653,349.6406,653,458.6406,643,468.6406,354,468.6406,354,359.6406" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="643" x2="652" y1="359.6406" y2="350.6406"/><line style="stroke: #000000; stroke-width: 1.5;" x1="354" x2="643" y1="359.6406" y2="359.6406"/><line style="stroke: #000000; stroke-width: 1.5;" x1="643" x2="643" y1="359.6406" y2="468.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="134" x="432.5" y="377.1738">OnionSeed.Data.dll</text><!--class SqlUnitOfWork--><rect fill="#FEFECE" filter="url(#f1ovnh6b4qthuz)" height="61.8359" id="SqlUnitOfWork" style="stroke: #A80036; stroke-width: 1.5;" width="178" x="429" y="127.1406"/><ellipse cx="473.75" cy="143.1406" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M476.5156,139.0156 Q476.6719,138.7969 476.8594,138.6875 Q477.0469,138.5781 477.2656,138.5781 Q477.6406,138.5781 477.875,138.8438 Q478.1094,139.0938 478.1094,139.7031 L478.1094,141.1563 Q478.1094,141.7656 477.875,142.0313 Q477.6406,142.2969 477.2656,142.2969 Q476.9219,142.2969 476.7188,142.0938 Q476.5156,141.9063 476.4063,141.3906 Q476.3594,141.0313 476.1719,140.8438 Q475.8438,140.4688 475.2344,140.25 Q474.625,140.0313 474,140.0313 Q473.2344,140.0313 472.5938,140.3594 Q471.9688,140.6875 471.4688,141.4375 Q470.9844,142.1875 470.9844,143.2188 L470.9844,144.3125 Q470.9844,145.5469 471.875,146.375 Q472.7656,147.1875 474.3594,147.1875 Q475.2969,147.1875 475.9531,146.9375 Q476.3438,146.7813 476.7656,146.3438 Q477.0313,146.0781 477.1719,146 Q477.3281,145.9219 477.5313,145.9219 Q477.8594,145.9219 478.1094,146.1875 Q478.375,146.4375 478.375,146.7813 Q478.375,147.125 478.0313,147.5313 Q477.5313,148.1094 476.7344,148.4375 Q475.6563,148.8906 474.3594,148.8906 Q472.8438,148.8906 471.6406,148.2656 Q470.6563,147.7656 469.9688,146.7031 Q469.2813,145.625 469.2813,144.3438 L469.2813,143.1875 Q469.2813,141.8594 469.8906,140.7188 Q470.5156,139.5625 471.6094,138.9531 Q472.7031,138.3281 473.9375,138.3281 Q474.6719,138.3281 475.3125,138.5 Q475.9688,138.6563 476.5156,139.0156 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="80" x="494.25" y="148.0508">SqlUnitOfWork</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="430" x2="606" y1="159.1406" y2="159.1406"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="430" x2="606" y1="167.1406" y2="167.1406"/><ellipse cx="440" cy="179.5586" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="152" x="449" y="182.5596">ctor(SqlConnection connection)</text><!--class IUnitOfWork--><rect fill="#FEFECE" filter="url(#f1ovnh6b4qthuz)" height="61.8359" id="IUnitOfWork" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="370.5" y="390.6406"/><ellipse cx="385.5" cy="406.6406" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M386.4531,403.2813 L386.4531,409.9375 L388.1719,409.9375 Q388.7813,409.9375 389.0469,410.1719 Q389.3125,410.4063 389.3125,410.7969 Q389.3125,411.1719 389.0469,411.4063 Q388.7813,411.6406 388.1719,411.6406 L383.0313,411.6406 Q382.4219,411.6406 382.1563,411.4063 Q381.8906,411.1719 381.8906,410.7813 Q381.8906,410.4063 382.1563,410.1719 Q382.4219,409.9375 383.0313,409.9375 L384.75,409.9375 L384.75,403.2813 L383.0313,403.2813 Q382.4219,403.2813 382.1563,403.0469 Q381.8906,402.8125 381.8906,402.4219 Q381.8906,402.0469 382.1563,401.8125 Q382.4219,401.5781 383.0313,401.5781 L388.1719,401.5781 Q388.7813,401.5781 389.0469,401.8125 Q389.3125,402.0469 389.3125,402.4219 Q389.3125,402.8125 389.0469,403.0469 Q388.7813,403.2813 388.1719,403.2813 L386.4531,403.2813 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="67" x="399.5" y="411.5508">IUnitOfWork</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="371.5" x2="468.5" y1="422.6406" y2="422.6406"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="371.5" x2="468.5" y1="430.6406" y2="430.6406"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="42" x="376.5" y="446.0596">Commit()</text><!--class IAsyncUnitOfWork--><rect fill="#FEFECE" filter="url(#f1ovnh6b4qthuz)" height="61.8359" id="IAsyncUnitOfWork" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="505" y="390.6406"/><ellipse cx="520" cy="406.6406" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M520.9531,403.2813 L520.9531,409.9375 L522.6719,409.9375 Q523.2813,409.9375 523.5469,410.1719 Q523.8125,410.4063 523.8125,410.7969 Q523.8125,411.1719 523.5469,411.4063 Q523.2813,411.6406 522.6719,411.6406 L517.5313,411.6406 Q516.9219,411.6406 516.6563,411.4063 Q516.3906,411.1719 516.3906,410.7813 Q516.3906,410.4063 516.6563,410.1719 Q516.9219,409.9375 517.5313,409.9375 L519.25,409.9375 L519.25,403.2813 L517.5313,403.2813 Q516.9219,403.2813 516.6563,403.0469 Q516.3906,402.8125 516.3906,402.4219 Q516.3906,402.0469 516.6563,401.8125 Q516.9219,401.5781 517.5313,401.5781 L522.6719,401.5781 Q523.2813,401.5781 523.5469,401.8125 Q523.8125,402.0469 523.8125,402.4219 Q523.8125,402.8125 523.5469,403.0469 Q523.2813,403.2813 522.6719,403.2813 L520.9531,403.2813 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="100" x="534" y="411.5508">IAsyncUnitOfWork</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="506" x2="636" y1="422.6406" y2="422.6406"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="506" x2="636" y1="430.6406" y2="430.6406"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="511" y="446.0596">CommitAsync() : Task</text><path d="M6,30.6406 L6,285.9141 L358,285.9141 L358,40.6406 L348,30.6406 L6,30.6406 " fill="#FBFB77" filter="url(#f1ovnh6b4qthuz)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M348,30.6406 L348,40.6406 L358,40.6406 L348,30.6406 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="12" y="49.1357">An implementation of</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="65" x="138" y="49.1357">IRepository</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="207" y="49.1357">may very well</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="12" y="65.4873">implement</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="73" x="76" y="65.4873">IUnitOfWork</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="153" y="65.4873">as well; both interfaces</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="288" x="12" y="81.8389">often apply to the same construct (i.e. a database</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="12" y="98.1904">connection object).</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="16" y="114.542"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="289" x="12" y="130.8936">However there is no reason for the interfaces to be</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="297" x="12" y="147.2451">related, as they are often used in different contexts.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="237" x="12" y="163.5967">For example, a web service might use an</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="65" x="253" y="163.5967">IRepository</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="325" x="12" y="179.9482">to perform a set of operations, and then a global wrapper</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="12" y="196.2998">around the web service may use the</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="73" x="224" y="196.2998">IUnitOfWork</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="11" x="301" y="196.2998">to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="12" y="212.6514">commit all the changes.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="16" y="229.0029"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="331" x="12" y="245.3545">Keeping the interfaces separate gives maximum flexibility</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="292" x="12" y="261.7061">in how they are consumed, while still allowing for a</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="212" x="12" y="278.0576">single, shared implementation class.</text><!--link SqlUnitOfWork to IUnitOfWork--><path d="M506.662,189.3936 C489.953,233.9796 458.531,317.8246 438.466,371.3656 " fill="none" id="SqlUnitOfWork-IUnitOfWork" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="444.96,373.9856,431.387,390.2567,431.85,369.0726,444.96,373.9856" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="459" y="330.1357">implements</text><!--link SqlUnitOfWork to IAsyncUnitOfWork--><path d="M524.132,189.3936 C533.108,233.6846 549.937,316.7186 560.797,370.3006 " fill="none" id="SqlUnitOfWork-IAsyncUnitOfWork" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="567.73,369.2646,564.842,390.2567,554.009,372.0456,567.73,369.2646" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="554" y="330.1357">implements</text><!--
@startuml UnitOfWork


title Unit of Work Pattern

node "OnionSeed.Data.SqlServer.dll" as SqlServer #LightGreen {
	class SqlUnitOfWork {
		+ ctor(SqlConnection connection)
	}
}

node "OnionSeed.Data.dll" as OnionSeed #LightBlue {
	interface IUnitOfWork {
		Commit()
	}

	interface IAsyncUnitOfWork {
		CommitAsync() : Task
	}
}

SqlUnitOfWork ..|> IUnitOfWork : implements
SqlUnitOfWork ..|> IAsyncUnitOfWork : implements

note as UnitOfWorkNote
	An implementation of <i>IRepository</i> may very well
	implement <i>IUnitOfWork</i> as well; both interfaces
	often apply to the same construct (i.e. a database
	connection object).

	However there is no reason for the interfaces to be
	related, as they are often used in different contexts.
	For example, a web service might use an <i>IRepository</i>
	to perform a set of operations, and then a global wrapper
	around the web service may use the <i>IUnitOfWork</i> to
	commit all the changes.

	Keeping the interfaces separate gives maximum flexibility
	in how they are consumed, while still allowing for a
	single, shared implementation class.
end note

@enduml

PlantUML version 1.2019.03(Sun Mar 10 05:04:44 MDT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 11.0.1+13-LTS
Operating System: Windows 10
OS Version: 10.0
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>